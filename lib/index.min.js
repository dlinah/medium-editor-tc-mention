!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("MediumEditor"));else if("function"==typeof define&&define.amd)define(["MediumEditor"],e);else{var n=e("object"==typeof exports?require("MediumEditor"):t.MediumEditor);for(var i in n)("object"==typeof exports?exports:t)[i]=n[i]}}(this,function(t){return function(t){function e(i){if(n[i])return n[i].exports;var s=n[i]={exports:{},id:i,loaded:!1};return t[i].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function s(t,e){var n,i,s=t.parentNode;for(o["default"].util.unwrap(t,e),i=s.lastChild;n=i.previousSibling;)3===i.nodeType&&3===n.nodeType&&(n.textContent+=i.textContent,s.removeChild(i)),i=n}Object.defineProperty(e,"__esModule",{value:!0}),e.unwrapForTextNode=s;var a=n(1),o=i(a),r=50;e.atKeyCode=r;var l=51;e.hashKeyCode=l;var d=o["default"].Extension.extend({name:"mention",extraClassName:"",extraActiveClassName:"",tagName:"strong",renderPanelContent:function(){},destroyPanelContent:function(){},activeTriggerList:["@"],triggerClassNameMap:{"#":"medium-editor-mention-hash","@":"medium-editor-mention-at"},hideOnBlurDelay:300,init:function(){this.initMentionPanel(),this.attachEventHandlers()},destroy:function(){this.mentionPanel&&(this.mentionPanel.parentNode&&(this.destroyPanelContent(this.mentionPanel),this.mentionPanel.parentNode.removeChild(this.mentionPanel)),delete this.mentionPanel)},initMentionPanel:function(){var t=this.document.createElement("div");t.classList.add("medium-editor-mention-panel"),this.extraClassName&&t.classList.add(this.extraClassName),this.getEditorOption("elementsContainer").appendChild(t),this.mentionPanel=t},attachEventHandlers:function(){null!=this.hideOnBlurDelay&&(this.subscribe("blur",this.handleBlur.bind(this)),this.subscribe("focus",this.handleFocus.bind(this))),this.subscribe("editableKeyup",this.handleKeyup.bind(this))},handleBlur:function(){null!=this.hideOnBlurDelay&&(this.hideOnBlurDelayId=setTimeout(this.hidePanel.bind(this),this.hideOnBlurDelay))},handleFocus:function(){this.hideOnBlurDelayId&&(clearTimeout(this.hideOnBlurDelayId),this.hideOnBlurDelayId=null)},handleKeyup:function(t){var e=o["default"].util.getKeyCode(t),n=e===o["default"].util.keyCode.SPACE;this.getWordFromSelection(t.target,n?-1:0),!n&&-1!==this.activeTriggerList.indexOf(this.trigger)&&1<this.word.length?this.showPanel():this.hidePanel()},hidePanel:function(){this.mentionPanel.classList.remove("medium-editor-mention-panel-active"),this.extraActiveClassName&&this.mentionPanel.classList.remove(this.extraActiveClassName),this.activeMentionAt&&(this.base.saveSelection(),s(this.activeMentionAt,this.document),this.base.restoreSelection(),this.activeMentionAt=null)},getWordFromSelection:function(t,e){function n(t,e){for(var n=!0;n;){var i=t,s=e;a=void 0,n=!1;var a=l[i-1];if(null==a||0===a.trim().length||0>=i||l.length<i)return i;t=i+s,e=s,n=!0}}var i=o["default"].selection.getSelectionRange(this.document),s=i.startContainer,a=i.startOffset,r=i.endContainer;i.endOffset;if(s===r){var l=s.textContent;this.wordStart=n(a+e,-1),this.wordEnd=n(a+e,1)-1,this.word=l.slice(this.wordStart,this.wordEnd),this.trigger=this.word.slice(0,1),this.triggerClassName=this.triggerClassNameMap[this.trigger]}},showPanel:function(){this.mentionPanel.classList.contains("medium-editor-mention-panel-active")||(this.activatePanel(),this.wrapWordInMentionAt()),this.positionPanel(),this.updatePanelContent()},activatePanel:function(){this.mentionPanel.classList.add("medium-editor-mention-panel-active"),this.extraActiveClassName&&this.mentionPanel.classList.add(this.extraActiveClassName)},wrapWordInMentionAt:function(){var t=this.document.getSelection();if(t.rangeCount){var e=t.getRangeAt(0).cloneRange();e.setStart(e.startContainer,this.wordStart),e.setEnd(e.startContainer,Math.min(this.wordEnd,e.startContainer.textContent.length));var n=this.document.createElement(this.tagName);n.classList.add(this.triggerClassName),this.activeMentionAt=n,e.surroundContents(n),t.removeAllRanges(),t.addRange(e),o["default"].selection.select(this.document,n.firstChild,this.word.length)}},positionPanel:function(){var t=this.activeMentionAt.getBoundingClientRect(),e=t.bottom,n=t.left,i=t.width,s=this.window,a=s.pageXOffset,o=s.pageYOffset;this.mentionPanel.style.top=o+e+"px",this.mentionPanel.style.left=a+n+i+"px"},updatePanelContent:function(){this.renderPanelContent(this.mentionPanel,this.word,this.handleSelectMention.bind(this))},handleSelectMention:function(t){if(t){var e=this.activeMentionAt.firstChild;e.textContent=t,o["default"].selection.select(this.document,e,t.length),this.hidePanel()}else this.hidePanel()}});e.TCMention=d,e["default"]=d},function(e,n){e.exports=t}])});
//# sourceMappingURL=index.min.js.map